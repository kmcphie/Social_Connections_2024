---
title: "Elliott_testing"
author: "Elliott Detjen"
date: "10/31/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(rstanarm)

sat_con <- responses_clean %>%
  select(group_size, satisfaction, pre_o, sports, race, gap_year, location) %>%
  group_by(race) %>%
  ggplot(aes(x = satisfaction, y = group_size, color = location, alpha = 0.5)) +
  geom_point(na.rm = FALSE) +
  geom_jitter() +
  geom_smooth(se = FALSE, echo = FALSE)

sat_con

responses_clean$satisfaction <- as.integer(as.character(responses_clean$satisfaction))
responses_clean$group_size <- as.integer(as.character(responses_clean$group_size))

class(responses_clean$group_size)


nice <- stan_glm(data = responses_clean,
                 formula = group_size ~ 1,
                 refresh = 0,
                 family = gaussian())

nice

graph <- nice %>%
  as_tibble() %>%
  rename(mu = `(Intercept)`) %>%
  ggplot(aes(x = mu)) +
  geom_histogram(aes(y = after_stat(count / sum(count))), binwidth = 0.1,
                 fill = "dodgerblue", alpha = 0.5)

graph

```


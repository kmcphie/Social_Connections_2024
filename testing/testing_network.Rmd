---
title: "Testing Network"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(igraph)
library(readr)
library(tidyverse)
library(shiny)
library(shinythemes)
library(readxl)
library(visNetwork)
library(network) 
library(sna)
library(ggraph)
library(threejs)
library(networkD3)
library(ndtv)
```

```{r}
# visNetwork testing 

nodes_responses <- responses_clean %>%
  filter(location == "The Yard") %>%
  select(id, location) %>%
  mutate(group = case_when(location == "The Yard" ~ "Student")) %>%
  mutate(label = id) %>%
  select(id, group, label)

edges_responses <- responses_clean %>%
  filter(location == "The Yard") %>%
  mutate(from = id) %>%
  mutate(to = sports) %>%
  select(from, to)

visNetwork(nodes_responses, edges_responses) %>%
  visGroups(groupname = "Dorms", color = "darkblue", shape = "square", size = 65) %>%
    visGroups(groupname = "Sports", color = "darkgreen", shape = "square", size = 45)

nodes <- data.frame(id = 1:10, group = c(rep("A", 5), rep("B", 5)))
edges <- data.frame(from = c(2:5, 6:10), to = c(1,2))

visNetwork(nodes, edges, width = "100%") %>% 
  # # darkblue square with shadow for group "A"
  # visGroups(groupname = "A", color = "darkblue", shape = "square", 
  #           shadow = list(enabled = TRUE)) %>% 
  # # red triangle for group "B"
  # visGroups(groupname = "B", color = "red", shape = "triangle") %>%
  visGroups(groupname = "Sports", color = "darkgreen", shape = "square", size = 45)
```

```{r}
id <- responses_clean %>%
  select(id) 

from <- responses_clean %>%
  select(id)

to <- responses_clean %>%
  mutate(to = case_when(sports == "No" ~ 1,
                         sports == "Yes (Varsity)" ~ 2,
                         sports == "Yes (Club)" ~ 3)) %>%
  select(to)

nodes <- data.frame(id = 1:390)
edges <- data.frame(from = 1:390,
                    to = to)
  
  visNetwork(nodes, edges)

```

```{r}
# We can use the graph_from_data_frame function, which takes two arguments: d,
# the data frame with the edge list in the first two columns; and vertices, a
# data frame with node data with the node label in the first column. (Note that
# igraph calls the nodes vertices, but itâ€™s exactly the same thing.)

test_nodes <- data.frame(id = 1:30)
test_edges <- data.frame(from = c(1:10, 11:20, 21:30), to = c(1,11,21))

test_network <- graph_from_data_frame(d=test_edges, vertices=test_nodes, directed=F)

plot(test_network)
```

```{r}
# Jeremiah's Code ---------------------------------------------------------


# output$mark_plot <- renderVisNetwork({
#   nodes2 <- read_csv("data/nodes2.csv")
#   edges2 <- read_csv("data/edges2.csv")
#   
#   # Changed shape, color, and size for each group
#   
#   visNetwork(nodes2, edges2) %>%
#     visGroups(groupname = "Dorms", color = "darkblue", shape = "square", size = 65) %>%
#     visGroups(groupname = "Pre-Orientation", color = "darkred", shape = "square", size = 45) %>%
#     visGroups(groupname = "Sports", color = "darkgreen", shape = "square", size = 45) %>%
#     
#     # Added functionality to highlight close connections when hovering over node
#     
#     visOptions(nodesIdSelection = list(enabled = TRUE,
#                                        style = "margin-bottom: -30px; visibility: hidden"),
#                highlightNearest = list(enabled = T, degree = 2, hover = T),
#                selectedBy = "group") %>%
#     
#     # Adjusted physics to decrease load time
#     
#     visPhysics(
#       solver = "forceAtlas2Based", 
#       timestep = 0.5,
#       minVelocity = 1,
#       maxVelocity = 30,
#       forceAtlas2Based = list(gravitationalConstant = -200, damping = 1),
#       stabilization = list(iterations = 300, updateInterval = 10),
#       adaptiveTimestep = TRUE) %>%
#     
#     # Added legend for groups
#     
#     visLegend(zoom = FALSE) %>%
#     
#     # Disabled graph movement within window
#     
#     visInteraction(dragView = FALSE, 
#                    zoomView = FALSE,
#                    navigationButtons = TRUE)
```